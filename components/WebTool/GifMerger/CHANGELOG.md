# GIF合并工具 更新日志

## [v2.1.3] - 2025-10-22

### 🔧 技术优化

#### 图像缩放插值方式优化

**修改内容**
- 设置画布缩放插值方式为最临近（Nearest-Neighbor）
- 通过 `ctx.imageSmoothingEnabled = false` 实现
- 作用于目标画布（缩放后的画布）

**效果**
- ✅ 保持像素清晰锐利
- ✅ 适合像素艺术风格的 GIF
- ✅ 放大时不会产生模糊
- ✅ 性能更好（计算更简单）

**适用场景**
- 像素艺术 GIF（8-bit 风格、复古游戏）
- 卡通动画 GIF（线条清晰的动画）
- 文字/图标 GIF（UI 元素演示）
- 需要保持清晰边缘的图像

### 📄 文档
- 新增 `IMAGE_SCALING_INTERPOLATION.md` - 插值方式详细说明

---

## [v2.1.2] - 2025-10-22

### 🐛 Bug修复

#### SizeInput 组件关键问题修复 v2

**问题1：选择选项后输入框内容闪烁**
- 修复：点击下拉选项后，输入框内容先变成选项值然后又变回原来内容
- 原因：`handleOptionClick` 中同时设置本地状态和调用 onChange，导致与 useEffect 的时序冲突
- 解决：移除 `setInputValue` 调用，统一由 useEffect 管理显示值
- 效果：选项选择后值正确显示，无闪烁现象

**问题2：输入完成后直接点击合成按钮，宽高未计算完成**
- 修复：输入框未失焦直接点击合成时，使用旧值合成的问题
- 原因：仅在失焦时调用 onChange，未失焦则值未被应用
- 解决：改为输入时实时调用 onChange，立即触发宽高比计算
- 效果：用户可实时看到宽高联动效果，无需等待失焦

**功能简化**
- 移除输入时筛选功能（根据用户反馈，逻辑复杂且易出错）
- 移除 `isTyping` 状态管理
- 简化事件处理逻辑
- 代码从 203 行减少到 173 行（-30行）

**用户体验提升**
- ✅ 实时宽高比计算
- ✅ 无闪烁现象
- ✅ 直接点击合成按钮无问题
- ✅ 逻辑更清晰，性能更好

### 📄 文档
- 新增 `BUGFIX_SIZEINPUT_V2.md` - 详细的第二轮bug修复报告

---

## [v2.1.1] - 2025-10-22

### 🐛 Bug修复

#### SizeInput 组件关键问题修复

**问题1：下拉框显示逻辑错误**
- 修复：点击下拉框时未显示完整预设选项列表的问题
- 原因：错误地根据当前输入值进行筛选
- 解决：引入 `isTyping` 状态标记，区分"用户输入"和"点击下拉"场景
- 效果：现在点击下拉框正确显示所有9个预设选项

**问题2：选项点击后数值设置错误**
- 修复：点击"256"选项后输入框显示"6"的严重bug
- 原因：输入过程中每个字符都触发 onChange，导致状态更新冲突
- 解决：延迟调用 onChange，仅在失焦或选择选项时提交
- 效果：选项点击和手动输入都能正确设置数值

**额外改进**
- 添加当前选中项高亮显示（深色背景 + 加粗）
- 防止下拉菜单与失焦事件冲突（使用 onMouseDown preventDefault）
- 优化输入筛选逻辑，仅在用户输入时启用

### 📄 文档
- 新增 `BUGFIX_SIZEINPUT.md` - 详细的bug修复报告

---

## [v2.1.0] - 2025-10-22

### ✨ 新增功能

#### 智能尺寸输入组件
- 新增 `SizeInput` 组件，提供更强大的尺寸调整能力
- 支持下拉选择和自由输入双模式
- 提供9个常用预设尺寸选项：
  - 原大小（动态显示实际尺寸）
  - 32px - 小图标
  - 64px - 中等图标
  - 128px - 大图标
  - 256px - 常规缩略图
  - 512px - 中等图片
  - 1024px - 高清图片
  - 1080px - Full HD
  - 2048px - 2K分辨率

#### 智能筛选功能
- 输入数字自动筛选匹配的预设选项
- 支持中文搜索（输入"原"可筛选出"原大小"）
- 实时过滤，提升选择效率

#### 用户体验优化
- 下拉箭头图标，清晰指示可展开
- 点击外部自动关闭下拉菜单
- 输入验证和错误恢复机制
- 平滑的动画过渡效果

### 🔄 改进

#### UI/UX 增强
- 优化输入框样式，与整体设计统一
- 改进下拉菜单视觉效果（圆角、阴影）
- 增强深色模式下的对比度
- 添加悬停状态反馈

#### 交互优化
- 选择预设值后自动关闭下拉菜单
- 失焦时智能验证和恢复
- 支持键盘输入的同时保留下拉便利性

### 📄 文档

#### 新增文档
- `SizeInput.md` - 组件详细文档
  - API 说明
  - 使用示例
  - 交互行为说明
  - 样式定制指南

#### 更新文档
- `RESIZE_FEATURE.md` - 更新功能说明
  - 添加智能筛选说明
  - 更新使用示例
  - 添加预设选项列表

---

## [v2.0.0] - 2025-10-22

### ✨ 新增功能

#### 图片尺寸调整
- 支持自定义输出GIF的宽度和高度
- 默认尺寸与合成后的原始尺寸一致
- 自动计算并显示原始合成尺寸

#### 宽高比锁定
- 默认锁定宽高比，防止图像变形
- 锁定状态下修改任一维度，另一维度自动按比例调整
- 可切换解锁状态，支持自定义宽高比

#### 双画布渲染
- 使用源画布按原始尺寸合成
- 使用目标画布按目标尺寸缩放
- 保持图像质量的同时实现尺寸调整

### 🎨 UI改进
- 在导出选项区域下方集成尺寸调整UI
- 显示原始尺寸信息作为参考
- 锁定/解锁图标直观易懂
- 完整支持深色模式

### 📝 技术实现
- 更新 `MergeOptions` 类型定义
- 添加 `targetWidth`、`targetHeight`、`lockAspectRatio` 字段
- 实现比例计算逻辑
- 优化画布渲染流程

---

## 版本说明

### 语义化版本
- **主版本号**：不兼容的API修改
- **次版本号**：向下兼容的功能新增
- **修订号**：向下兼容的问题修正

### 更新类型
- ✨ 新增功能
- 🔄 改进优化
- 🐛 Bug修复
- 📄 文档更新
- 🎨 UI/样式改进
- ⚡ 性能优化
- 🔒 安全修复
