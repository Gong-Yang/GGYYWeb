# GIF合并工具 - 图片尺寸调整功能

## 功能概述

在GIF合并导出模块中新增了图片尺寸调整功能，允许用户自定义输出GIF的宽度和高度。

## 主要特性

### 1. 默认尺寸
- 输出图片的宽度和高度默认与合成后的原始尺寸一致
- 系统会自动计算并显示原始合成尺寸

### 2. 尺寸输入
- 提供两个智能输入框，支持下拉选择和自由输入：
  - **宽度（像素）**：可输入 1-10000 像素
  - **高度（像素）**：可输入 1-10000 像素

- **预设尺寸选项**：
  - 原大小（显示实际原始尺寸值）
  - 32px
  - 64px
  - 128px
  - 256px
  - 512px
  - 1024px
  - 1080px
  - 2048px

- **智能筛选**：
  - 输入数字时自动筛选匹配的预设选项
  - 支持模糊搜索（如输入"128"会显示128px）
  - 输入"原"可快速找到原大小选项

### 3. 宽高比锁定
- **锁定状态（默认）**：
  - 图标显示为"锁定"状态（深色背景）
  - 修改宽度时，高度会按原始比例自动调整
  - 修改高度时，宽度会按原始比例自动调整
  - 确保输出图片不会变形

- **解锁状态**：
  - 图标显示为"解锁"状态（浅色背景）
  - 允许独立修改宽度和高度
  - 可以创建自定义宽高比的输出

### 4. UI集成
- 尺寸调整选项位于导出选项区域的下方
- 显示原始尺寸信息作为参考
- 采用统一的设计风格，支持深色模式
- 响应式布局，适配不同屏幕尺寸

## 技术实现

### 新增组件 (`SizeInput.tsx`)
创建了一个可搜索的下拉输入组件，具有以下特性：
- 支持键盘输入和下拉选择双模式
- 实时过滤预设选项
- 点击外部自动关闭下拉菜单
- 输入验证和错误处理
- 完整的暗色模式支持

### 类型定义更新 (`types.ts`)
```typescript
export interface MergeOptions {
  // ... 其他选项
  targetWidth?: number;      // 目标宽度（像素）
  targetHeight?: number;     // 目标高度（像素）
  lockAspectRatio: boolean;  // 是否锁定宽高比
}
```

### 核心功能

#### 1. 原始尺寸计算
- 当GIF文件列表变化时自动计算合成后的原始尺寸
- 支持网格模式和连续播放模式的不同计算方式

#### 2. 尺寸调整逻辑
- **宽度调整**：修改宽度时，如果锁定比例则自动计算高度
- **高度调整**：修改高度时，如果锁定比例则自动计算宽度
- **比例锁定切换**：点击锁定按钮切换锁定/解锁状态

#### 3. 画布渲染
- 使用双画布渲染策略：
  - **源画布**：按原始尺寸合成所有帧
  - **目标画布**：按目标尺寸缩放渲染
- 保持图像质量的同时实现尺寸调整
- 正确处理透明背景和不同背景色

## 使用示例

### 使用预设尺寸
1. 上传GIF文件后，系统显示原始尺寸（如：800 × 600 px）
2. 点击宽度输入框的下拉箭头
3. 从下拉菜单中选择"512px"
4. 高度自动按比例调整为 384px
5. 点击"平面合并"或"连续合并"生成GIF

### 快速选择原大小
1. 在宽度或高度输入框中输入"原"
2. 选项会筛选出"原大小 (800px)"
3. 点击选择，恢复为原始尺寸

### 自由输入尺寸
1. 解锁宽高比
2. 在宽度输入框中直接输入自定义值（如 1500）
3. 在高度输入框中输入另一个值（如 900）
4. 生成自定义尺寸的GIF

### 智能筛选
1. 在输入框中输入"10"
2. 下拉菜单自动筛选显示：1024px, 1080px
3. 选择需要的尺寸

## 注意事项

1. **性能考虑**：
   - 大幅放大可能导致文件体积增大和处理时间延长
   - 建议合理设置目标尺寸

2. **质量影响**：
   - 放大图片可能导致清晰度下降
   - 使用canvas缩放算法，质量取决于浏览器实现

3. **比例维护**：
   - 建议保持锁定状态以维持原始宽高比
   - 非比例缩放可能导致图像变形

## 兼容性

- 与现有的所有导出选项完全兼容
- 支持所有背景色模式（透明、原图、白色、黑色）
- 在网格合并和连续合并两种模式下均可使用
- 完全支持深色模式
